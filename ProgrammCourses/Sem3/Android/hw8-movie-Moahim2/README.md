# Анимации

## Базовая версия

### Что надо

Предоставить нечто, содержащее
 - Анимацию через property animations
   - Можно через xml
   - Можно через `.animate()`
 - Анимированную View
   - Должна иметь настраиваемые через xml аттрибуты
   - Должна сохранять состояние анимации
   - Должна работать через `.onDraw(Canvas)`
 
### Критерии провала

 - Устаревший фреймворк
 - Создание объектов в `onDraw(Canvas)`
 - Модификация холста без `.save()`/`.restore()`

### Штрафы

 - Warning
 - Безусловный `.invalidate()` в `.onDraw(Canvas)`
   - Почему?</br>
     Так вы привязываетесь в FPS, что может плохо кончиться.

## Бонусная версия

Прикрутите это всё к ДЗ 4+ и получите 5 очков сверху!

### Что надо

 - См. выше
 - Анимация должна говорить о том, что кто-то что-то печатает
   - Должна находится в "шапке" открытого чата
     - см. `Toolbar`
   - В качестве своей View подойдёт какая-нибудь анимация
   - В качестве анимированной внешне вьюшки — список печатающих
     - Можно, например, менять альфу
     - Можно, например, "бегать" точками
 - Список печатающих брать из web socket'а (см. ниже)
 - Реализовать надо _только_ для каналов
   - Вероятно, сервер вам спокойно отдаст не только каналы, это надо 
     игнорировать 
 
### Дополнительные штрафы к бонусу

 - Polling</br>
   Это когда вы периодически опрашиваете сервер

### API

Соединяться через `ws://213.189.221.170:8008/ws/<имя>`

Для реализации клиента можно взять [WS из OkHttp](https://square.github.io/okhttp/4.x/okhttp/okhttp3/-web-socket/)

Для начального значения можно спросить `GET /typing/<чат>` 
и получить список печатающих в этом чате.

```json lines
// События в сторону клиента
// Изменился список печатающих
{
  "TypingChanged": {
    "<chat name1>": ["<user 1>", "<user 2>"],
    "<chat name2>": ["<user 3>"],
    // и так далее
  }
}
// Новое сообщение
{
  "NewMessage": {
    "msg": { /* тут сообщение из ДЗ 4..7 */ }
  }
}
// События в сторону сервера
// Пользователь начал печатать
{
  "StartTyping": {
    "chat": "<chat name>"
  }
}
// Пользователь закончил печатать
{
  "EndTyping": {}
}
// Отправить текстовое сообщение
{
  "NewMessageText": {
    "to": "<chat name>",
    "text": "<text>"
  }
}
```

### Как проверять локально

[Браузерный клиент для канала js@channel](http://213.189.221.170:8008/wsClient)